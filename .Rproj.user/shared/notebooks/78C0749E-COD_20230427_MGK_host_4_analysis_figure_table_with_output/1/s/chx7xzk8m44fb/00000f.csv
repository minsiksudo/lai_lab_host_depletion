"0",""
"0",""
"0","phyloseq$phyloseq_path_cpm <- transform_sample_counts(phyloseq$phyloseq_path_rpk, function(x){x/sum(x)*1000000})"
"0",""
"0","a <- tax_table(subset_samples(phyloseq$phyloseq_path_cpm,"
"0","                              sample_type == ""Mock"") %>%"
"0","        subset_samples(.,"
"0","                       baylor_other_id != ""20220606_Neg"") %>%"
"0","                transform_sample_counts(., function(x){ifelse(is.na(x), 0, x)})"
"0","        ) %>%"
"0","        cbind(species20 = ""[Other]"") %>%"
"0","        {top20species <- head(taxa_sums(subset_samples(phyloseq$phyloseq_path_cpm,"
"0","                              sample_type == ""Mock"") %>%"
"0","        subset_samples(.,"
"0","                       baylor_other_id != ""20220606_Neg"") %>%"
"0","                transform_sample_counts(., function(x){ifelse(is.na(x), 0, x)})) %>%"
"0","                                data.frame %>%"
"0","                                arrange(-.) %>%"
"0","                                row.names(), 10)"
"0","   .[top20species, ""species20""] <- as.character(.[top20species, ""pathway""])"
"0","   .[, 3] <- gsub(""s__"", "" "", .[, 3])"
"0","   .[, 3] <- gsub(""_"", "" "", .[, 3])"
"0","   .[, 3] <- gsub(""[]]|[[]"", """",  .[, 3])"
"0","   .[, 3] <- gsub("" sp"", "" sp."",  .[, 3])"
"0","   .[, 3] <- gsub("" sp."", ""</i> sp."",  .[, 3])"
"0","   .[, 3] <- gsub("" group"", ""</i> group."",  .[, 3])"
"0","   .[, 3] <- ifelse(grepl(""Other"",.[, 3]),"
"0","                    ""Other"","
"0","                    ifelse(grepl(""</i>"",  .[, 3]),"
"0","                           paste(""<i>"",  .[, 3], sep = """"),"
"0","                           paste(""<i>"",  .[, 3], ""</i>"", sep = """")) %>%"
"0","                            gsub(""s__"", """", .) %>%"
"0","                            gsub(""_"", "" "", .)"
"0","   )"
"0","   phyloseq_temp <- subset_samples(phyloseq$phyloseq_path_cpm,"
"0","                              sample_type == ""Mock"") %>%"
"0","        subset_samples(.,"
"0","                       baylor_other_id != ""20220606_Neg"") %>%"
"0","                transform_sample_counts(., function(x){ifelse(is.na(x), 0, x)})"
"0","   tax_table(phyloseq_temp) <- tax_table(.) "
"0","   phyloseq_temp"
"0","  } %>%"
"0","        my_plot_bar(., fill=""species20"") + "
"0","        ylab(""Relative abundancne"") +"
"0","        theme_classic(base_size = 11, base_family = ""sans"") +"
"0","        theme(legend.text = element_markdown(), "
"0","              axis.text.x = element_text(size = 0)) +"
"0","        guides(fill=guide_legend(title=""Top 10 species"")) +"
"0","        scale_fill_manual(values = c(RColorBrewer::brewer.pal(n = 11, name = ""Paired""))) +"
"0","        facet_wrap (~ treatment, scales= ""free_x"", nrow = 1) +"
"0","        #facet_wrap (~ factor(sample_type, levels = c(""Mock"", ""BAL"", ""Nasal"", ""Sputum"")),"
"0","        #            scales= ""free_x"", nrow=2) +"
"0","        labs(tag=""D"") + "
"0","        ggtitle(""Mock"")"
"0",""
"0",""
"0",""
"0","b <- tax_table(subset_samples(phyloseq$phyloseq_path_cpm,"
"0","                              sample_type == ""Neg."") %>%"
"0","        subset_samples(.,"
"0","                       baylor_other_id != ""20220606_Neg"") %>%"
"0","                transform_sample_counts(., function(x){ifelse(is.na(x), 0, x)})"
"0","        ) %>%"
"0","        cbind(species20 = ""[Other]"") %>%"
"0","        {top20species <- head(taxa_sums(subset_samples(phyloseq$phyloseq_path_cpm,"
"0","                              sample_type == ""Neg."") %>%"
"0","        subset_samples(.,"
"0","                       baylor_other_id != ""20220606_Neg"") %>%"
"0","                transform_sample_counts(., function(x){ifelse(is.na(x), 0, x)})) %>%"
"0","                                data.frame %>%"
"0","                                arrange(-.) %>%"
"0","                                row.names(), 10)"
"0","   .[top20species, ""species20""] <- as.character(.[top20species, ""pathway""])"
"0","   .[, 3] <- gsub(""s__"", "" "", .[, 3])"
"0","   .[, 3] <- gsub(""_"", "" "", .[, 3])"
"0","   .[, 3] <- gsub(""[]]|[[]"", """",  .[, 3])"
"0","   .[, 3] <- gsub("" sp"", "" sp."",  .[, 3])"
"0","   .[, 3] <- gsub("" sp."", ""</i> sp."",  .[, 3])"
"0","   .[, 3] <- gsub("" group"", ""</i> group."",  .[, 3])"
"0","   .[, 3] <- ifelse(grepl(""Other"",.[, 3]),"
"0","                    ""Other"","
"0","                    ifelse(grepl(""</i>"",  .[, 3]),"
"0","                           paste(""<i>"",  .[, 3], sep = """"),"
"0","                           paste(""<i>"",  .[, 3], ""</i>"", sep = """")) %>%"
"0","                            gsub(""s__"", """", .) %>%"
"0","                            gsub(""_"", "" "", .)"
"0","   )"
"0","   phyloseq_temp <- subset_samples(phyloseq$phyloseq_path_cpm,"
"0","                              sample_type == ""Neg."") %>%"
"0","        subset_samples(.,"
"0","                       baylor_other_id != ""20220606_Neg"") %>%"
"0","                transform_sample_counts(., function(x){ifelse(is.na(x), 0, x)})"
"0","   tax_table(phyloseq_temp) <- tax_table(.) "
"0","   phyloseq_temp"
"0","  } %>%"
"0","        my_plot_bar(., fill=""species20"") + "
"0","        ylab(""Relative abundancne"") +"
"0","        theme_classic(base_size = 11, base_family = ""sans"") +"
"0","        theme(legend.text = element_markdown(), "
"0","              axis.text.x = element_text(size = 0)) +"
"0","        guides(fill=guide_legend(title=""Top 10 species"")) +"
"0","        scale_fill_manual(values = c(RColorBrewer::brewer.pal(n = 11, name = ""Paired""))) +"
"0","        facet_wrap (~ treatment, scales= ""free_x"", nrow = 1) +"
"0","        #facet_wrap (~ factor(sample_type, levels = c(""Mock"", ""BAL"", ""Nasal"", ""Sputum"")),"
"0","        #            scales= ""free_x"", nrow=2) +"
"0","        labs(tag=""E"") + "
"0","        ggtitle(""Negative controls"")"
"0",""
"0",""
"0",""
"0","c <- tax_table(subset_samples(phyloseq$phyloseq_path_cpm,"
"0","                              sample_type == ""BAL"") %>%"
"0","        subset_samples(.,"
"0","                       baylor_other_id != ""20220606_Neg"") %>%"
"0","                transform_sample_counts(., function(x){ifelse(is.na(x), 0, x)})) %>%"
"0","        cbind(species20 = ""[Other]"") %>%"
"0","        {top20species <- head(taxa_sums(subset_samples(phyloseq$phyloseq_path_cpm,"
"0","                              sample_type == ""BAL"") %>%"
"0","        subset_samples(.,"
"0","                       baylor_other_id != ""20220606_Neg"") %>%"
"0","                transform_sample_counts(., function(x){ifelse(is.na(x), 0, x)})) %>%"
"0","                                data.frame %>%"
"0","                                arrange(-.) %>%"
"0","                                row.names(), 10)"
"0","   .[top20species, ""species20""] <- as.character(.[top20species, ""pathway""])"
"0","   .[, 3] <- gsub(""s__"", "" "", .[, 3])"
"0","   .[, 3] <- gsub(""_"", "" "", .[, 3])"
"0","   .[, 3] <- gsub(""[]]|[[]"", """",  .[, 3])"
"0","   .[, 3] <- gsub("" sp"", "" sp."",  .[, 3])"
"0","   .[, 3] <- gsub("" sp."", ""</i> sp."",  .[, 3])"
"0","   .[, 3] <- gsub("" group"", ""</i> group."",  .[, 3])"
"0","   .[, 3] <- ifelse(grepl(""Other"",.[, 3]),"
"0","                    ""Other"","
"0","                    ifelse(grepl(""</i>"",  .[, 3]),"
"0","                           paste(""<i>"",  .[, 3], sep = """"),"
"0","                           paste(""<i>"",  .[, 3], ""</i>"", sep = """")) %>%"
"0","                            gsub(""s__"", """", .) %>%"
"0","                            gsub(""_"", "" "", .)"
"0","   )"
"0","   phyloseq_temp <- subset_samples(phyloseq$phyloseq_path_cpm,"
"0","                              sample_type == ""BAL"") %>%"
"0","        subset_samples(.,"
"0","                       baylor_other_id != ""20220606_Neg"") %>%"
"0","                transform_sample_counts(., function(x){ifelse(is.na(x), 0, x)})"
"0","   tax_table(phyloseq_temp) <- tax_table(.) "
"0","   phyloseq_temp"
"0","  } %>%"
"0","        my_plot_bar(., fill=""species20"") + "
"0","        ylab(""Relative abundancne"") +"
"0","        theme_classic(base_size = 11, base_family = ""sans"") +"
"0","        theme(legend.text = element_markdown(), axis.text.x = element_blank()) +"
"0","        guides(fill=guide_legend(title=""Top 10 species"")) +"
"0","        scale_fill_manual(values = c(RColorBrewer::brewer.pal(n = 11, name = ""Paired""))) +"
"0","        facet_wrap (~ treatment, scales= ""free_x"", nrow = 1) +"
"0","        #facet_wrap (~ factor(sample_type, levels = c(""Mock"", ""BAL"", ""Nasal"", ""Sputum"")),"
"0","        #            scales= ""free_x"", nrow=2) +"
"0","        labs(tag=""A"") + "
"0","        ggtitle(""BAL"")"
"0",""
"0",""
"0",""
"0","d <- tax_table(subset_samples(phyloseq$phyloseq_path_cpm,"
"0","                              sample_type == ""Nasal"") %>%"
"0","        subset_samples(.,"
"0","                       baylor_other_id != ""20220606_Neg"") %>%"
"0","                transform_sample_counts(., function(x){ifelse(is.na(x), 0, x)})"
"0","        ) %>%"
"0","        cbind(species20 = ""[Other]"") %>%"
"0","        {top20species <- head(taxa_sums(subset_samples(phyloseq$phyloseq_path_cpm,"
"0","                              sample_type == ""Nasal"") %>%"
"0","        subset_samples(.,"
"0","                       baylor_other_id != ""20220606_Neg"") %>%"
"0","                transform_sample_counts(., function(x){ifelse(is.na(x), 0, x)})) %>%"
"0","                                data.frame %>%"
"0","                                arrange(-.) %>%"
"0","                                row.names(), 10)"
"0","   .[top20species, ""species20""] <- as.character(.[top20species, ""pathway""])"
"0","   .[, 3] <- gsub(""s__"", "" "", .[, 3])"
"0","   .[, 3] <- gsub(""_"", "" "", .[, 3])"
"0","   .[, 3] <- gsub(""[]]|[[]"", """",  .[, 3])"
"0","   .[, 3] <- gsub("" sp"", "" sp."",  .[, 3])"
"0","   .[, 3] <- gsub("" sp."", ""</i> sp."",  .[, 3])"
"0","   .[, 3] <- gsub("" group"", ""</i> group."",  .[, 3])"
"0","   .[, 3] <- ifelse(grepl(""Other"",.[, 3]),"
"0","                    ""Other"","
"0","                    ifelse(grepl(""</i>"",  .[, 3]),"
"0","                           paste(""<i>"",  .[, 3], sep = """"),"
"0","                           paste(""<i>"",  .[, 3], ""</i>"", sep = """")) %>%"
"0","                            gsub(""s__"", """", .) %>%"
"0","                            gsub(""_"", "" "", .)"
"0","   )"
"0","   phyloseq_temp <- subset_samples(phyloseq$phyloseq_path_cpm,"
"0","                              sample_type == ""Nasal"") %>%"
"0","        subset_samples(.,"
"0","                       baylor_other_id != ""20220606_Neg"") %>%"
"0","                transform_sample_counts(., function(x){ifelse(is.na(x), 0, x)})"
"0","   tax_table(phyloseq_temp) <- tax_table(.) "
"0","   phyloseq_temp"
"0","  } %>%"
"0","        my_plot_bar(., fill=""species20"") + "
"0","        ylab(""Relative abundancne"") +"
"0","        theme_classic(base_size = 11, base_family = ""sans"") +"
"0","        theme(legend.text = element_markdown(), axis.text.x = element_blank()) +"
"0","        guides(fill=guide_legend(title=""Top 10 species"")) +"
"0","        scale_fill_manual(values = c(RColorBrewer::brewer.pal(n = 11, name = ""Paired""))) +"
"0","        facet_wrap (~ treatment, scales= ""free_x"", nrow = 1) +"
"0","        #facet_wrap (~ factor(sample_type, levels = c(""Mock"", ""BAL"", ""Nasal"", ""Sputum"")),"
"0","        #            scales= ""free_x"", nrow=2) +"
"0","        labs(tag=""B"") + "
"0","        ggtitle(""Nasal swabs"")"
"0",""
"0",""
"0",""
"0","e <- tax_table(subset_samples(phyloseq$phyloseq_path_cpm,"
"0","                              sample_type == ""Sputum"") %>%"
"0","        subset_samples(.,"
"0","                       baylor_other_id != ""20220606_Neg"") %>%"
"0","                transform_sample_counts(., function(x){ifelse(is.na(x), 0, x)})) %>%"
"0","        cbind(species20 = ""[Other]"") %>%"
"0","        {top20species <- head(taxa_sums(subset_samples(phyloseq$phyloseq_path_cpm,"
"0","                              sample_type == ""Sputum"") %>%"
"0","        subset_samples(.,"
"0","                       baylor_other_id != ""20220606_Neg"") %>%"
"0","                transform_sample_counts(., function(x){ifelse(is.na(x), 0, x)})) %>%"
"0","                                data.frame %>%"
"0","                                arrange(-.) %>%"
"0","                                row.names(), 10)"
"0","   .[top20species, ""species20""] <- as.character(.[top20species, ""pathway""])"
"0","   .[, 3] <- gsub(""s__"", "" "", .[, 3])"
"0","   .[, 3] <- gsub(""_"", "" "", .[, 3])"
"0","   .[, 3] <- gsub(""[]]|[[]"", """",  .[, 3])"
"0","   .[, 3] <- gsub("" sp"", "" sp."",  .[, 3])"
"0","   .[, 3] <- gsub("" sp."", ""</i> sp."",  .[, 3])"
"0","   .[, 3] <- gsub("" group"", ""</i> group."",  .[, 3])"
"0","   .[, 3] <- ifelse(grepl(""Other"",.[, 3]),"
"0","                    ""Other"","
"0","                    ifelse(grepl(""</i>"",  .[, 3]),"
"0","                           paste(""<i>"",  .[, 3], sep = """"),"
"0","                           paste(""<i>"",  .[, 3], ""</i>"", sep = """")) %>%"
"0","                            gsub(""s__"", """", .) %>%"
"0","                            gsub(""_"", "" "", .)"
"0","   )"
"0","   phyloseq_temp <- subset_samples(phyloseq$phyloseq_path_cpm,"
"0","                              sample_type == ""Neg."") %>%"
"0","        subset_samples(.,"
"0","                       baylor_other_id != ""20220606_Neg"") %>%"
"0","                transform_sample_counts(., function(x){ifelse(is.na(x), 0, x)})"
"0","   tax_table(phyloseq_temp) <- tax_table(.) "
"0","   phyloseq_temp"
"0","  } %>%"
"0","        my_plot_bar(., fill=""species20"") + "
"0","        ylab(""Relative abundancne"") +"
"0","        theme_classic(base_size = 11, base_family = ""sans"") +"
"0","        theme(legend.text = element_markdown(), axis.text.x = element_blank()) +"
"0","        guides(fill=guide_legend(title=""Top 10 species"")) +"
"0","        scale_fill_manual(values = c(RColorBrewer::brewer.pal(n = 11, name = ""Paired""))) +"
"0","        facet_wrap (~ treatment, scales= ""free_x"", nrow = 1) +"
"0","        #facet_wrap (~ factor(sample_type, levels = c(""Mock"", ""BAL"", ""Nasal"", ""Sputum"")),"
"0","        #            scales= ""free_x"", nrow=2) +"
"0","        labs(tag=""C"") + "
"0","        ggtitle(""Sputum"")"
"0",""
"0",""
"0","a"
