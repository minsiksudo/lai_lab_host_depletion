"0","#Manipulating phyloseq - only top 10 "
"0","phyloseq_control_rel <- subset_samples(phyloseq_rel_nz, sample_type == ""Mock"" | sample_type == ""Neg."")"
"0","phyloseq_control_rel_contam <- subset_taxa(phyloseq_control_rel,"
"0","                                           !(taxa_names(phyloseq_control_rel) %in%"
"0","                                                       head("
"0","                                                               taxa_sums("
"0","                                                                       subset_samples("
"0","                                                                               phyloseq_control_rel,"
"0","                                                                               sample_type == ""Mock"" &"
"0","                                                                                       S.obs != 0)) %>%"
"0","                                data.frame %>%"
"0","                                arrange(-.) %>%"
"0","                                row.names(), 10))"
"0",")"
"0",""
"0","phyloseq_control_rel_contam <- subset_taxa(phyloseq_control_rel_contam, taxa_sums(phyloseq_control_rel_contam) != 0)"
"0","phyloseq_control_rel_contam <- subset_samples(phyloseq_control_rel_contam, sample_type != ""Neg."" & S.obs != 0)"
"0",""
"0",""
"0","tax_table(phyloseq_control_rel_contam) %>%"
"0","        cbind(species20 = ""[Others]"") %>%"
"0","        {top20species <- head(taxa_sums(phyloseq_control_rel_contam) %>%"
"0","                                data.frame %>%"
"0","                                arrange(-.) %>%"
"0","                                row.names(), 10)"
"0","   .[top20species, ""species20""] <- as.character(.[top20species, ""Species""])"
"0","   .[, 9] <- .[, 9] %>% gsub(""s__"", """", .) %>% gsub(""_"", "" "", .) %>% paste(""<i>"", ., ""</i>"", sep = """")"
"0","   phyloseq_temp <- phyloseq_control_rel_contam"
"0","   tax_table(phyloseq_temp) <- tax_table(.) "
"0","   phyloseq_temp"
"0","  } %>%"
"0","        plot_bar(., fill=""species20"") + "
"0","        ylab(""Relative abundancne"") +"
"0","        theme_classic(base_size = 11, base_family = ""serif"") +"
"0","        ggtitle(""Contaminants in Zymo mock (denominator is total microbes in samples)"") +"
"0","        theme(legend.text = element_markdown()) +"
"0","        guides(fill=guide_legend(title=""Top 10 species"")) +"
"0","        facet_wrap (~ factor(treatment, levels = c(""Untreated"", ""lyPMA"", ""Benzonase"", ""HostZERO"", ""MolYsis"", ""QIAamp"")),"
"0","                    scales= ""free_x"", nrow=1)"
