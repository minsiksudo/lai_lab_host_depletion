"0",""
"0","sample_data(phyloseq$phyloseq_count)$sequencing_fail <- "
"0","        ifelse(phyloseq$phyloseq_count %>% "
"0","                       sample_data %>%"
"0","                       .$S.obs == 0,"
"0","               1,"
"0","               0)"
"0",""
"0","sample_data(phyloseq$phyloseq_count) <- "
"0","        "
"0","        merge(phyloseq$phyloseq_count %>% "
"0","                      sample_data %>%"
"0","                      data.frame(check.names = F),"
"0","              phyloseq$phyloseq_path_rpk %>% #extracting function richness as dataframe"
"0","                      sample_data %>%"
"0","                      data.frame(check.names = F) %>% "
"0","                     dplyr::select(c(""S.obs"")) %>%"
"0","                      rename(F.obs = ""S.obs""),"
"0","              by = 0"
"0","        ) %>%"
"0","                column_to_rownames(""Row.names"")"
"0",""
"0","table1 <- sample_data(phyloseq$phyloseq_count) %>% data.frame() %>% "
"0","        dplyr::filter(sample_type %in% c(""Sputum"", ""Nasal"", ""BAL"")) %>% "
"0","        group_by (sample_type, treatment) %>%"
"0","        summarise(`N` = n(),"
"0","            #      `Total DNA <br>ng/µL` = paste(format(round(median(picogreen_ng_ul),2), nsmall = 2, big.mark = "",""), ""<br>("", format(round(quantile(picogreen_ng_ul, 0.25),2), nsmall = 2, big.mark = "",""), "", "", format(round(quantile(picogreen_ng_ul, 0.75),2), nsmall = 2, big.mark = "",""), "")"", sep = """"),"
"0","               `Human DNA <br>pg/µL` = paste(format(round(median(DNA_host_ng_uL*1000),1), nsmall = 1, big.mark = "",""), "" ("", format(round(quantile(DNA_host_ng_uL*1000, 0.25),1), nsmall = 1, big.mark = "",""), "", "", format(round(quantile(DNA_host_ng_uL*1000, 0.75),1), nsmall = 1, big.mark = "",""), "")"", sep = """"),"
"0","               `Bacterial DNA <br>pg/µL` = paste(format(round(median(DNA_bac_ng_uL*1000),1), nsmall = 1, big.mark = "",""), "" ("", format(round(quantile(DNA_bac_ng_uL*1000, 0.25),1), nsmall = 1, big.mark = "",""), "", "", format(round(quantile(DNA_bac_ng_uL*1000, 0.75),1), nsmall = 1, big.mark = "",""), "")"", sep = """"),"
"0","              `Sequencing fail<br>N (%)` = paste(sum(lib_failed + sequencing_fail), "" ("", sum(lib_failed +sequencing_fail) / n() * 100, "" %)"", sep = """"),"
"0","              `QC'd reads<br>reads x 10<sup>6</sup>` = paste(format(round(median(Reads_after_trim/1000000),1), nsmall = 1, big.mark = "",""), "" ("", format(round(quantile(Reads_after_trim/1000000, 0.25),1), nsmall = 1, big.mark = "",""), "", "", format(round(quantile(Reads_after_trim/1000000, 0.75),1), nsmall = 1, big.mark = "",""), "")"", sep = """"),"
"0","              `Host reads<br>%` = paste(format(round(median(sequencing_host_prop*100),1),"
"0","                                                nsmall = 1, big.mark = "",""),"
"0","                                         "" ("","
"0","                                         format(round(quantile(sequencing_host_prop * 100,"
"0","                                                               0.25),"
"0","                                                      1),"
"0","                                                nsmall = 1,"
"0","                                                big.mark = "",""), "
"0","                                         "", "", "
"0","                                         format(round(quantile(sequencing_host_prop * 100, 0.75),1), "
"0","                                                nsmall = 1, "
"0","                                                big.mark = "",""), "
"0","                                         "")"", "
"0","                                         sep = """"),"
"0","             `Final reads<br>reads x 10<sup>6</sup>` = paste(format(round(median(Final_reads/1000000,"
"0","                                                                                 na.rm = T),"
"0","                                                                          1),"
"0","                                                                    nsmall = 1, big.mark = "",""),"
"0","                                                             "" ("", "
"0","                                                             format(round(quantile(Final_reads/1000000,"
"0","                                                                                            0.25,"
"0","                                                                                            na.rm = T),"
"0","                                                                                   1),"
"0","                                                                             nsmall = 1,"
"0","                                                                             big.mark = "",""),"
"0","                                                             "", "","
"0","                                                             format(round(quantile(Final_reads/1000000, "
"0","                                                                                   0.75, "
"0","                                                                                   na.rm = T),"
"0","                                                                          1), "
"0","                                                                    nsmall = 1, "
"0","                                                                    big.mark = "",""), "
"0","                                                             "")"","
"0","                                                             sep = """"),"
"0","             `Species<br>richness` = paste(median(S.obs, na.rm = T),"
"0","                                                             "" ("", "
"0","                                                             quantile(S.obs, 0.25, na.rm = T),"
"0","                                                             "", "","
"0","                                                             quantile(S.obs, 0.75, na.rm = T),"
"0","                                                             "")"","
"0","                                                             sep = """"),"
"0","            `Function<br>richness` = paste(median(F.obs, na.rm = T),"
"0","                                                             "" ("", "
"0","                                                             quantile(F.obs, 0.25, na.rm = T),"
"0","                                                             "", "","
"0","                                                             quantile(F.obs, 0.75, na.rm = T),"
"0","                                                             "")"","
"0","                                                             sep = """")"
"0","              "
"0","            ) %>% "
"0","        data.frame(check.names = F) %>% "
"0","        arrange(sample_type, treatment) %>%"
"0","        rename(`Sample` = sample_type, Treatment = treatment) %>%"
"0","        mutate_all(linebreak) %>% kbl(format = ""html"", escape = F) %>% kable_styling(full_width = 0, html_font = ""sans"")"
"0",""
"0","table1 "
