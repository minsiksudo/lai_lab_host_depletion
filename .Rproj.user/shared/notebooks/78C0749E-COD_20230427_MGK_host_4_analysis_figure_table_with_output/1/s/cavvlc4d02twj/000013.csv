"0",""
"0","tax_table(subset_samples(phyloseq$phyloseq_rel,"
"0","                              sample_type == ""Mock"")) %>%"
"0","        cbind(species20 = ""[Other]"") %>%"
"0","        {top20species <- head(taxa_sums(subset_samples(phyloseq$phyloseq_rel,"
"0","                              sample_type == ""Mock"") %>% "
"0","           subset_samples(., S.obs != 0)) %>%"
"0","                                data.frame %>%"
"0","                                arrange(-.) %>%"
"0","                                row.names(), 20)"
"0","   .[top20species, ""species20""] <- as.character(.[top20species, ""Species""])"
"0","   .[, 9] <- gsub(""s__"", "" "", .[, 9])"
"0","   .[, 9] <- gsub(""_"", "" "", .[, 9])"
"0","   .[, 9] <- gsub(""[]]|[[]"", """",  .[, 9])"
"0","   .[, 9] <- gsub("" sp"", "" sp."",  .[, 9])"
"0","   .[, 9] <- gsub("" sp."", ""</i> sp."",  .[, 9])"
"0","   .[, 9] <- gsub("" group"", ""</i> group."",  .[, 9])"
"0","   .[, 9] <- ifelse(grepl(""Other"",.[, 9]),"
"0","                    ""Other"","
"0","                    ifelse(grepl(""</i>"",  .[, 9]),"
"0","                           paste(""<i>"",  .[, 9], sep = """"),"
"0","                           paste(""<i>"",  .[, 9], ""</i>"", sep = """")) %>%"
"0","                            gsub(""s__"", """", .) %>%"
"0","                            gsub(""_"", "" "", .)"
"0","   )"
"0","   phyloseq_temp <- subset_samples(phyloseq$phyloseq_rel,"
"0","                              sample_type == ""Mock"") %>% "
"0","           subset_samples(., S.obs != 0)"
"0","   tax_table(phyloseq_temp) <- tax_table(.) "
"0","   phyloseq_temp"
"0","  } %>%"
"0","        my_plot_bar(., fill=""species20"") + "
"0","        xlab(""Subject"") +"
"0","        ylab("""") +"
"0","        theme_classic(base_size = 11, base_family = ""sans"") +"
"0","        theme(legend.text = element_markdown(size = 6),"
"0","              legend.key.size = unit(3, ""mm""),"
"0","              legend.title = element_text(size = 6),"
"0","              axis.text.x = element_text(color = ""white"")) +"
"0","        guides(fill=guide_legend(title=""Top 20 species"")) +"
"0","        scale_fill_manual(values = c(RColorBrewer::brewer.pal(n = 9, name = ""Set3""),"
"0","                                     RColorBrewer::brewer.pal(n = 12, name = ""Paired"")"
"0","                                     )) +"
"0","        facet_wrap (~ treatment, scales = ""free_x"", nrow = 1)"
