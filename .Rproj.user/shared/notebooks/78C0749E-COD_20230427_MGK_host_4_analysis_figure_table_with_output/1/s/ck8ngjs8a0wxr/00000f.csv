"0",""
"0","#ffff33 qia"
"0",""
"0","f5b <- merge(filt_fit_data_bal$rel %>%"
"0","              gather(treatment,"
"0","                     value,"
"0","                     Untreated:QIAamp,"
"0","                     factor_key=TRUE),"
"0","      filt_fit_data_bal$data_italic %>%"
"0","              rownames_to_column(""feature"") %>%"
"0","              gather(treatment,"
"0","                     qval,"
"0","                     lyPMA:QIAamp,"
"0","                     factor_key=TRUE),"
"0","      by.x = c('feature', 'treatment'),"
"0","      by.y = c('feature', 'treatment'),"
"0","      all = T) %>%"
"0","        "
"0","        merge(filt_fit_data_bal$data_sig %>%"
"0","              rownames_to_column(""feature"") %>%"
"0","              gather(treatment,"
"0","                     sig,"
"0","                     lyPMA:QIAamp,"
"0","                     factor_key=TRUE),"
"0","              by.x = c('feature', 'treatment'),"
"0","              by.y = c('feature', 'treatment'),"
"0","              all = T) %>%"
"0","        mutate(sig = case_when(is.na(qval) ~ ""> 0.1"","
"0","                               qval < 0.1 ~ ""< 0.1"","
"0","                               .default = ""> 0.1"")) %>%"
"0",""
"0","#Baloon plot"
"0","        ggballoonplot(size = ""value"", y = ""feature"", x= ""treatment"", fill = ""sig"") +"
"0","        theme_classic(base_family = ""sans"") +"
"0","        #colors for qvalues"
"0","        #xlab(""Experimental group"") +"
"0","        #ylab(""Species"") +"
"0","        labs(tag = ""A"")  +"
"0","        ggtitle(""BAL"") +"
"0","        theme(panel.grid.major = element_line(colour = ""grey""),"
"0","              legend.position = ""top"","
"0","              #axis.text.x = element_text(angle = 45, vjust = 1, hjust=1),"
"0","              #Element markdown for taxa name italicizing"
"0","              axis.text.y = ggtext::element_markdown(size = 8),"
"0","              axis.title.y = element_blank(),"
"0","              axis.title.x = element_blank(),"
"0","              plot.margin = unit(c(0,0.2,0,1), 'lines'))  +"
"0","        scale_fill_manual(values = c(""grey"", ""red""), aes(y = feature,"
"0","                      x = treatment,"
"0","                      label = sig)) +"
"0","        guides(fill = guide_legend(title = c(expression(paste(italic(""q""),"
"0","                                                       ""-value"","
"0","                                                       sep = """"))),"
"0","                                   title.position = ""top""),"
"0","               size = guide_legend(title = ""Relative abundance"","
"0","                                   title.position = ""top"","
"0","                                   order = 1,"
"0","                                   nrow = 1)"
"0","               ) + "
"0","        scale_x_discrete(labels=c(""control"" = ""Untreated"","
"0","                                  ""lypma"" = ""lyPMA"","
"0","                                  ""benzonase"" = ""Benzonase"","
"0","                                  ""host_zero"" = ""Host-zero"","
"0","                                  ""molysis"" = ""MolYsis"","
"0","                                  ""qiaamp"" = ""QIAamp"")"
"0","                         )"
"0",""
"0","f5c <- merge(filt_fit_data_ns$rel %>%"
"0","              gather(treatment,"
"0","                     value,"
"0","                     Untreated:QIAamp,"
"0","                     factor_key=TRUE),"
"0","      filt_fit_data_ns$data_italic %>%"
"0","              rownames_to_column(""feature"") %>%"
"0","              gather(treatment,"
"0","                     qval,"
"0","                     lyPMA:QIAamp,"
"0","                     factor_key=TRUE),"
"0","      by.x = c('feature', 'treatment'),"
"0","      by.y = c('feature', 'treatment'),"
"0","      all = T) %>%"
"0","        "
"0","        merge(filt_fit_data_ns$data_sig %>%"
"0","              rownames_to_column(""feature"") %>%"
"0","              gather(treatment,"
"0","                     sig,"
"0","                     lyPMA:QIAamp,"
"0","                     factor_key=TRUE),"
"0","              by.x = c('feature', 'treatment'),"
"0","              by.y = c('feature', 'treatment'),"
"0","              all = T) %>%"
"0","        mutate(sig = case_when(sig < 0.1 ~ ""< 0.1"","
"0","                               .default = ""> 0.1"")) %>%"
"0","#Baloon plot"
"0","        ggballoonplot(size = ""value"", y = ""feature"", x= ""treatment"", fill = ""sig"") +"
"0","        "
"0","        theme_classic(base_family = ""sans"") +"
"0","        #colors for qvalues"
"0","        gradient_fill(c(""#006d2c"", ""#edf8fb"")) +"
"0","        xlab(""Experimental group"") +"
"0","        ylab(""Species"") +"
"0","        labs(tag = ""B"")  +"
"0","        ggtitle(""Nasal swab"") +"
"0","        theme(panel.grid.major = element_line(colour = ""grey""),"
"0","              legend.position = ""top"","
"0","              #axis.text.x = element_text(angle = 45, vjust = 1, hjust=1),"
"0","              #Element markdown for taxa name italicizing"
"0","              axis.text.y = ggtext::element_markdown(size = 8),"
"0","              axis.title.x = element_blank(),"
"0","              plot.margin = unit(c(0,0.2,0,1), 'lines'))  +"
"0","        #Adding significance asterisks"
"0","        scale_fill_manual(values = c(""red"", ""grey""), aes(y = feature,"
"0","                      x = treatment,"
"0","                      label = sig)) +"
"0","        guides(fill = guide_legend(title = c(expression(paste(italic(""q""),"
"0","                                                       ""-value"","
"0","                                                       sep = """"))),"
"0","                                   title.position = ""top"","
"0","                                   override.aes = list(size=5)),"
"0","               size = guide_legend(title = ""Relative abundance"","
"0","                                   title.position = ""top"","
"0","                                   order = 1,"
"0","                                   nrow = 1),"
"0","               ) + "
"0","        scale_x_discrete(labels=c(""control"" = ""Untreated"","
"0","                                  ""lypma"" = ""lyPMA"","
"0","                                  ""benzonase"" = ""Benzonase"","
"0","                                  ""host_zero"" = ""Host-zero"","
"0","                                  ""molysis"" = ""MolYsis"","
"0","                                  ""qiaamp"" = ""QIAamp"")"
"0","                         )"
"0",""
"0","f5d <- merge(filt_fit_data_spt$rel %>%"
"0","              gather(treatment,"
"0","                     value,"
"0","                     Untreated:QIAamp,"
"0","                     factor_key=TRUE),"
"0","      filt_fit_data_spt$data_italic %>%"
"0","              rownames_to_column(""feature"") %>%"
"0","              gather(treatment,"
"0","                     qval,"
"0","                     lyPMA:QIAamp,"
"0","                     factor_key=TRUE),"
"0","      by.x = c('feature', 'treatment'),"
"0","      by.y = c('feature', 'treatment'),"
"0","      all = T) %>%"
"0","        merge(filt_fit_data_spt$data_sig %>%"
"0","              rownames_to_column(""feature"") %>%"
"0","              gather(treatment,"
"0","                     sig,"
"0","                     lyPMA:QIAamp,"
"0","                     factor_key=TRUE),"
"0","              by.x = c('feature', 'treatment'),"
"0","              by.y = c('feature', 'treatment'),"
"0","              all = T) %>%"
"0","        mutate(sig = case_when(sig < 0.1 ~ ""< 0.1"","
"0","                               .default = ""> 0.1"")) %>%"
"0","#Baloon plot"
"0","        ggballoonplot(size = ""value"", y = ""feature"", x= ""treatment"", fill = ""sig"") +"
"0","        "
"0","        theme_classic(base_family = ""sans"") +"
"0","        #colors for qvalues"
"0","        gradient_fill(c(""#006d2c"", ""#edf8fb"")) +"
"0","        xlab(""Experimental group"") +"
"0","        #ylab(""Species"") +"
"0","        labs(tag = ""C"")  +"
"0","        ggtitle(""Sputum"") +"
"0","        theme(panel.grid.major = element_line(colour = ""grey""),"
"0","              legend.position = ""top"","
"0","              #axis.text.x = element_text(angle = 45, vjust = 1, hjust=1),"
"0","              #Element markdown for taxa name italicizing"
"0","              axis.text.y = ggtext::element_markdown(size = 8),"
"0","              #axis.title.x = element_blank(),"
"0","              axis.title.x = element_text(margin = margin(t = 0)),"
"0","              axis.title.y = element_blank(),"
"0","              plot.margin = unit(c(0,0.2,0,1), 'lines'))  +"
"0","        #Adding significance asterisks"
"0","        scale_fill_manual(values = c(""red"", ""grey""), aes(y = feature,"
"0","                      x = treatment,"
"0","                      label = sig)) +"
"0","        guides(fill = guide_legend(title = c(expression(paste(italic(""q""),"
"0","                                                       ""-value"","
"0","                                                       sep = """"))),"
"0","                                   title.position = ""top""),"
"0","               size = guide_legend(title = ""Relative abundance"","
"0","                                   title.position = ""top"","
"0","                                   order = 1,"
"0","                                   nrow = 1),"
"0","               ) + "
"0","        scale_x_discrete(labels=c(""control"" = ""Untreated"","
"0","                                  ""lypma"" = ""lyPMA"","
"0","                                  ""benzonase"" = ""Benzonase"","
"0","                                  ""host_zero"" = ""Host-zero"","
"0","                                  ""molysis"" = ""MolYsis"","
"0","                                  ""qiaamp"" = ""QIAamp"")"
"0","                         )"
"0",""
"0","fig4 <- ggarrange(f5c %>% lemon::g_legend() %>% as_ggplot,"
"0","                  f5b,"
"0","                  f5c,"
"0","                  f5d,"
"0","                  #b, b %>% lemon::g_legend() %>% as_ggplot,"
"0","                  ncol=1, heights = c(1.5, 4, 4, 4),"
"0","                  legend = ""none"","
"0","                  align = ""hv"")"
"0",""
"0","fig4"
